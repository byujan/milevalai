# MilEvalAI v1.6 Testing Guide

Complete testing checklist for the new AI-powered workflow.

## Pre-Testing Setup

### 1. Install Ollama
```bash
# macOS
brew install ollama

# Or use curl
curl https://ollama.ai/install.sh | sh
```

### 2. Pull llama3.2 Model
```bash
ollama pull llama3.2
```

### 3. Start Ollama Server
```bash
ollama serve
```

Keep this terminal open!

### 4. Update Database
1. Go to Supabase SQL Editor
2. Run the updated `supabase/schema.sql`
3. Verify new tables exist:
   - `evaluations` (updated columns)
   - `bullet_library` (new)
   - `rater_tendencies` (new)

### 5. Start MilEvalAI
```bash
npm run dev
```

---

## Test Flow 1: Complete Evaluation (Without Predecessor)

### Step 1: Create Evaluation
- [ ] Click "New Evaluation" from dashboard
- [ ] Enter duty title: "Company First Sergeant"
- [ ] Select NCOER
- [ ] Select "Change of Rater"
- [ ] Select "E6-E8"
- [ ] Click "Next"

**Expected**: Redirects to predecessor upload page

### Step 2: Skip Predecessor
- [ ] Click "Skip this step"

**Expected**: Redirects to bullet drafting page

### Step 3: Draft Bullets
- [ ] Click "Show Examples" - verify examples appear
- [ ] Enter 5-10 bullets (or paste from clipboard)
- [ ] Example bullets to test:
  ```
  Led 15-soldier team through 6-month deployment with 100% mission success
  Trained 25 junior NCOs achieving 95% certification rate
  Managed $2M equipment inventory with zero losses
  Coordinated joint training with 5 sister units
  Mentored 12 soldiers resulting in 8 promotions
  ```
- [ ] Click "Add Bullet" - verify new bullet field appears
- [ ] Click "Continue to AI Categorization"

**Expected**: Redirects to categorization page with loading spinner

### Step 4: AI Categorization
- [ ] Wait for AI processing (30-60 seconds for 5-10 bullets)
- [ ] Verify bullets are categorized into tabs
- [ ] Check each category tab:
  - [ ] Character
  - [ ] Presence
  - [ ] Intellect
  - [ ] Leads
  - [ ] Develops
  - [ ] Achieves
- [ ] For each bullet, verify:
  - [ ] Original text shown in gray
  - [ ] Enhanced text shown prominently
  - [ ] Confidence score displayed (e.g., "93%")
  - [ ] Category makes sense
- [ ] Test "Regenerate" button on one bullet
- [ ] Click "Continue to Rater Comments"

**Expected**: All bullets categorized and enhanced

### Step 5: Rater Comments
- [ ] Wait for AI to generate comments (10-15 seconds)
- [ ] Verify comments appear in textarea
- [ ] Check word count (should be 100-150 words)
- [ ] Edit the text manually
- [ ] Click "Regenerate" - verify new comments generated
- [ ] Click "Continue to Senior Rater Comments"

**Expected**: Professional rater paragraph generated

### Step 6: Senior Rater Comments
- [ ] Verify rater comments shown as reference
- [ ] Wait for AI to generate senior rater comments
- [ ] Check word count (should be 150-200 words)
- [ ] Verify comments build on but don't repeat rater comments
- [ ] Edit if needed
- [ ] Click "Continue to Review & Export"

**Expected**: Strategic-level senior rater paragraph generated

### Step 7: Review & Export
- [ ] Verify issues/validations shown
- [ ] Click "Export Evaluation"
- [ ] Test "Copy EES Text"
- [ ] Verify evaluation shown on dashboard

**Expected**: Evaluation complete and exportable

---

## Test Flow 2: With Predecessor Upload

### Step 1-2: Create Evaluation
Same as Flow 1, but at predecessor page:

- [ ] Drag and drop a PDF/Word file
- [ ] Verify file appears with name and size
- [ ] Click "Upload & Continue"
- [ ] Verify "Analyzing predecessor..." message

**Expected**: File uploads successfully

### Continue Flow
Follow steps 3-7 from Flow 1

---

## Test Flow 3: Error Handling

### Test Ollama Not Running
1. Stop Ollama server (Ctrl+C in Ollama terminal)
2. Create evaluation and add bullets
3. Try to categorize

**Expected**: Error message about Ollama not running

### Test Invalid File Upload
- [ ] Try uploading a .exe file

**Expected**: Error message about invalid file type

### Test Empty Bullets
- [ ] Try to continue from draft page with all bullets empty

**Expected**: Alert asking to add at least one bullet

---

## Test Flow 4: Dashboard Features

### Delete Evaluation
- [ ] Click "Delete" on an evaluation
- [ ] Verify confirmation modal appears
- [ ] Click "Cancel" - modal closes
- [ ] Click "Delete" again
- [ ] Click "Delete" in modal
- [ ] Verify evaluation removed from list

**Expected**: Evaluation deleted successfully

### Multiple Evaluations
- [ ] Create 3+ evaluations
- [ ] Verify all shown in dashboard
- [ ] Click on each to verify they load

**Expected**: All evaluations accessible

---

## Performance Tests

### Single Bullet Processing
- [ ] Add 1 bullet
- [ ] Time the categorization

**Expected**: < 5 seconds

### 10 Bullets Processing
- [ ] Add 10 bullets
- [ ] Time the categorization

**Expected**: 30-60 seconds

### Comment Generation
- [ ] Time rater comment generation
- [ ] Time senior rater comment generation

**Expected**: Each < 15 seconds

---

## Edge Cases

### Very Long Bullet
```
Led a highly complex 15-soldier team through an extended 6-month deployment in a high-stress combat environment maintaining 100% mission readiness while simultaneously managing multiple concurrent operations and training exercises with zero incidents or failures across all metrics and maintaining high morale throughout
```
- [ ] Verify AI handles long text
- [ ] Check enhanced version is still coherent

### Very Short Bullet
```
Led team
```
- [ ] Verify AI enhances appropriately
- [ ] Check it doesn't add false information

### Special Characters
```
Led team (15 soldiers) achieving 100% success @ FOB; coordinated w/ BDE
```
- [ ] Verify special characters handled correctly

---

## Browser Testing

Test in:
- [ ] Chrome
- [ ] Firefox  
- [ ] Safari
- [ ] Edge

---

## Mobile Testing

Test on mobile (responsive design):
- [ ] iPhone Safari
- [ ] Android Chrome
- [ ] Tablet

---

## Known Issues to Verify

1. **First Load Slow**
   - [ ] First AI call is slower (~10-20 seconds)
   - [ ] Subsequent calls faster

2. **Model Loading**
   - [ ] If Ollama just started, first call may take 30 seconds

3. **File Upload Size**
   - [ ] Files over 10MB should be rejected

---

## Regression Tests (Old Features Still Work)

- [ ] Sign up
- [ ] Sign in
- [ ] Sign out
- [ ] Dashboard loads
- [ ] Old evaluation pages still accessible
- [ ] Export still works

---

## Success Criteria

All tests pass:
- [ ] Complete evaluation flow works end-to-end
- [ ] AI categorization accurate
- [ ] AI enhancement improves bullets
- [ ] Comments generation works
- [ ] No errors in console
- [ ] Performance acceptable
- [ ] Mobile responsive
- [ ] Database saves correctly

---

## Reporting Issues

If you find issues, note:
1. What you were doing
2. What happened
3. What you expected
4. Browser/OS
5. Console errors
6. Ollama logs

---

## Quick Test Checklist

For quick testing (5 minutes):
- [ ] Ollama running
- [ ] Create evaluation
- [ ] Skip predecessor
- [ ] Add 3 bullets
- [ ] AI categorizes successfully
- [ ] Rater comments generate
- [ ] Senior rater comments generate
- [ ] Export works

**If these all pass, v1.6 is working!** âœ…

---

## Advanced Testing

### API Testing
```bash
# Test categorize endpoint
curl -X POST http://localhost:3000/api/ai/categorize \
  -H "Content-Type: application/json" \
  -d '{"bullets":["Led team to success"],"rankLevel":"E6-E8"}'

# Test enhance endpoint
curl -X POST http://localhost:3000/api/ai/enhance \
  -H "Content-Type: application/json" \
  -d '{"bullet":"Led team","category":"Leads","rankLevel":"E6-E8"}'
```

### Database Testing
```sql
-- Check evaluations
SELECT id, duty_title, status, created_at 
FROM evaluations 
ORDER BY created_at DESC 
LIMIT 5;

-- Check raw bullets
SELECT id, duty_title, raw_bullets 
FROM evaluations 
WHERE raw_bullets IS NOT NULL;

-- Check categorized bullets
SELECT id, duty_title, categorized_bullets 
FROM evaluations 
WHERE categorized_bullets IS NOT NULL;
```

---

**Happy Testing! ðŸ§ª**

